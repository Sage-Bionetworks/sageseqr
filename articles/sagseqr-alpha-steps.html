<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Run the drake plan in version 0.0.0.9-alpha â€¢ sageseqr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Run the drake plan in version 0.0.0.9-alpha">
<meta property="og:description" content="sageseqr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sageseqr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/customize-config.html">Write your own config file</a>
    </li>
    <li>
      <a href="../articles/run-the-plan.html">Run the targets plan</a>
    </li>
    <li>
      <a href="../articles/sagseqr-alpha-steps.html">Run the drake plan in version 0.0.0.9-alpha</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Sage-Bionetworks/sageseqr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sagseqr-alpha-steps_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Run the drake plan in version 0.0.0.9-alpha</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Sage-Bionetworks/sageseqr/blob/master/vignettes/sagseqr-alpha-steps.Rmd"><code>vignettes/sagseqr-alpha-steps.Rmd</code></a></small>
      <div class="hidden name"><code>sagseqr-alpha-steps.Rmd</code></div>

    </div>

    
    
<p>In <code>sageseqr</code> version 0.0.0.9-alpha, <code>sageseqr</code> was built with the workflow R package called <a href="https://books.ropensci.org/drake/"><code>drake</code></a>. There are differences between the latest version of <code>sageseqr</code> and the alpha version when it comes to executing the workflow. As new features are always being released, the latest release of the package is recommended! However, if you are reproducing an analysis that depends on the alpha version of the package, follow these instructions.</p>
<ol style="list-style-type: decimal">
<li><p>Install the package <code>remotes::install_github("Sage-Bionetworks/sageseqr@v0.0.0.9-alpha")</code>.</p></li>
<li><p>Write your own config file.</p></li>
</ol>
<pre><code>counts:
  synID:          Required. Synapse ID to counts data frame with identifiers to 
                  the metadata as column names and gene ids in a column.
  version:        Optional. Include Synapse file version number (e.g. 3).
  gene id:        Required. Column name that corresponds to the gene ids (e.g. feature).
metadata:
  synID:          Required. Synapse ID to cleaned metadata file with sample 
                  identifiers in a column and variables of interest as column names. 
  version:        Optional. Include Synapse file version number (e.g. 3).
  sample id:      Required. Column name that corresponds to the sample ids (e.g. donorid).
biomart:
  synID:          Optional. If left blank, Ensembl will be queried with the gene 
                  ids provided in the counts. Otherwise, you may provide the
                  Synapse ID to gene metadata from Ensembl. This must include gene
                  length and GC content in order to implement Conditional Quantile
                  Normalization. 
  version:        Optional. Include Synapse file version number (e.g. 3).
  filters:        Required. Column name that corresponds to the gene ids (e.g. 
                  ensembl_gene_id).
  host:           Optional. A character vector specifying the BioMart database release
                  version. This specification is highly recommended for a reproducible           
                  workflow. Defaults to ensembl.org.
  organism:       Required. A character vector of the organism name. This argument 
                  takes partial strings. For example,"hsa" will match "hsapiens_gene_ensembl".
factors:          Required. List of factor variables in brackets. Variables must be 
                  present in the metadata as column names (e.g. [ "donorid", "source"]).
continuous:       Required. List of continuous variables in brackets. Variables must 
                  be present in the metadata as column names (e.g. [ "rin", "rin2"]).
x_var:            Required. A boxplot will visualize the distribution of continuous variables using
                  the x_var as a dimension.
conditions:       Optional. Filtering low-expression genes is a common practice to improve
                  sensitivity in detection of differentially expressed genes. Low
                  count genes that have less than a user-defined threshold of counts 
                  per million (CPM) in a user-defined percentage of samples per the
                  conditions provided here will be removed. (e.g. ["diagnosis", "sex"]). 
cpm threshold:    Optional. The minium allowable CPM to keep a gene in the analysis.
percent threshold:Optional. The percentage of samples that should contain the minimum number
                  of CPM. If a condition is passed, the percentage will apply to 
                  the samples in that sub-population. 
sex check:        Optional. The exact variable name that corresponds to reported gender or sex
                  to check the distribution of x and y marker expression across
                  samples.
dimensions:       Required. Specify the PCA dimensions by variable name. 
  color:
  shape:
  size:
skip model:       Optional. If TRUE, the exploratory data report is run. Model selection
                  is not computed.
force model with: Optional. Force differential expression with this user defined model
                  instead of the output of stepwise regression.
de FC:            The fold-change (FC) of significant differentially expressed 
                  (de) genes must exceed this value. This value will be transformed
                  into log2 FC.
de p-value threshold: The adjusted p-value of significant differentially expressed 
                  (de) genes must exceed this value.
de contrasts:     Required. Variable in the metadata to define comparisons between 
                  groups.
  &lt;any named list:&gt; If there are multiple comparisons, set them up as nested lists.
visualization gene list: Label this list of genes in the volcano plot.
report:           Required. The name of your project. This will become the name of your 
                  output html file.
store output:     Required. Folder Synapse Id to store output on Synapse.</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Specify the active configuration by setting <code>R_CONFIG_ACTIVE</code>.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>R_CONFIG_ACTIVE <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Load the <code>sageseqr</code> library and login to <a href="https://www.synapse.org/">Synapse</a>. <code>rnaseq_plan()</code> calls the arguments from the config file and creates the <code>drake</code> plan. Execute <code>drake::make(plan)</code> to compute. Run this code from your project root.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sage-bionetworks.github.io/sageseqr">sageseqr</a></span><span class="op">)</span>

<span class="co"># Login to Synapse. Make a Synapse account and use synapser to login: https://r-docs.synapse.org/articles/manageSynapseCredentials.html</span>
<span class="fu">synapser</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/synapser/man/synLogin.html">synLogin</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Run the analysis</span>
<span class="va">plan</span> <span class="op">&lt;-</span> <span class="fu">sageseqr</span><span class="fu">::</span><span class="fu">rnaseq_plan</span><span class="op">(</span>
  metadata_id <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"metadata"</span><span class="op">)</span><span class="op">$</span><span class="va">synID</span>,
  metadata_version <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"metadata"</span><span class="op">)</span><span class="op">$</span><span class="va">version</span>,
  counts_id <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"counts"</span><span class="op">)</span><span class="op">$</span><span class="va">synID</span>,
  counts_version <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"counts"</span><span class="op">)</span><span class="op">$</span><span class="va">version</span>,
  gene_id_input <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"counts"</span><span class="op">)</span><span class="op">$</span><span class="va">`gene id`</span>,
  sample_id_input <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"metadata"</span><span class="op">)</span><span class="op">$</span><span class="va">`sample id`</span>,
  factor_input <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"factors"</span><span class="op">)</span>,
  continuous_input <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"continuous"</span><span class="op">)</span>,
  biomart_id <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"biomart"</span><span class="op">)</span><span class="op">$</span><span class="va">synID</span>,
  biomart_version <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"biomart"</span><span class="op">)</span><span class="op">$</span><span class="va">version</span>,
  filters <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"biomart"</span><span class="op">)</span><span class="op">$</span><span class="va">filters</span>,
  host <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"biomart"</span><span class="op">)</span><span class="op">$</span><span class="va">host</span>,
  organism <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"biomart"</span><span class="op">)</span><span class="op">$</span><span class="va">organism</span>, 
  conditions <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"conditions"</span><span class="op">)</span>, 
  cpm_threshold <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"cpm threshold"</span><span class="op">)</span>,
  conditions_threshold <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"percent threshold"</span><span class="op">)</span>,
  primary_variable <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"x_var"</span><span class="op">)</span>, 
  de_contrasts <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"de contrasts"</span><span class="op">)</span>,
  fold_change_threshold <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"de FC"</span><span class="op">)</span>,
  p_value_threshold <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"de p-value threshold"</span><span class="op">)</span>,
  sex_var <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"sex check"</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"dimensions"</span><span class="op">)</span><span class="op">$</span><span class="va">color</span>, 
  shape <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"dimensions"</span><span class="op">)</span><span class="op">$</span><span class="va">shape</span>,
  size <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"dimensions"</span><span class="op">)</span><span class="op">$</span><span class="va">size</span>,
  report_name <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"report"</span><span class="op">)</span>,
  skip_model <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"skip model"</span><span class="op">)</span>,
  parent_id <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"store output"</span><span class="op">)</span>,
  rownames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"metadata"</span><span class="op">)</span><span class="op">$</span><span class="va">`sample id`</span>,
    <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"counts"</span><span class="op">)</span><span class="op">$</span><span class="va">`gene id`</span>,
    <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"biomart"</span><span class="op">)</span><span class="op">$</span><span class="va">filters</span>,
    <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"counts"</span><span class="op">)</span><span class="op">$</span><span class="va">`gene id`</span>
    <span class="op">)</span>,
  config_file <span class="op">=</span> <span class="st">"config.yml"</span>,
  force_model <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"force model with"</span><span class="op">)</span>, 
  gene_list <span class="op">=</span> <span class="fu">config</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/config/man/get.html">get</a></span><span class="op">(</span><span class="st">"visualization gene list"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">drake</span><span class="fu">::</span><span class="fu">make</span><span class="op">(</span>
  <span class="va">plan</span>,
  envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-reflect.html">getNamespace</a></span><span class="op">(</span><span class="st">"sageseqr"</span><span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Visualize the results of your work.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">drake</span><span class="fu">::</span><span class="fu">vis_drake_graph</span><span class="op">(</span>
  <span class="va">plan</span>,
  envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-reflect.html">getNamespace</a></span><span class="op">(</span><span class="st">"sageseqr"</span><span class="op">)</span>,
  targets_only <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kelsey Montgomery, Jake Gockley, Daisy Han.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
